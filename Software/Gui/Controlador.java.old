import java.util.HashMap;

import javafx.event.Event;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.Slider;
import javafx.scene.control.TextField;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;

class sliderControl {
    public Slider slider;
    public TextField valueTextField, stepTextField;
    public Button stepUpButton, stepDownButton;

    sliderControl(Slider slider, TextField value, TextField step, Button stepUp, Button stepDown) {
        this.slider = slider;
        this.valueTextField = value;
        this.stepTextField = step;
        this.stepUpButton = stepUp;
        this.stepDownButton = stepDown;
    }

}

public class Controlador {
    @FXML
    public Slider j1Slider, j2Slider, j3Slider, zSlider, gripperSlider, velSlider, accelSlider;

    @FXML
    public TextField j1Value, j2Value, j3Value, zValue, gripperValue, velValue, accelValue;

    @FXML
    public TextField j1Step, j2Step, j3Step, zStep, gripperStep, velStep, accelStep;

    @FXML
    public Button j1Up, j2Up, j3Up, zUp, gripperUp, velUp, accelUp;

    @FXML
    public Button j1Down, j2Down, j3Down, zDown, gripperDown, velDown, accelDown;

    @FXML
    public Button saveButton, startButton, updateButton;

    private HashMap<Slider, TextField> paresSliderTexto = new HashMap<Slider, TextField>();
    private HashMap<TextField, Slider> paresTextoSlider = new HashMap<TextField, Slider>();

    @FXML
    public void initialize() {
        // // Disgusting
        // paresSliderTexto.put(j1Slider, j1Value);
        // paresSliderTexto.put(j2Slider, j2Value);
        // paresSliderTexto.put(j3Slider, j3Value);
        // paresSliderTexto.put(zSlider, zValue);
        // paresSliderTexto.put(gripperSlider, gripperValue);
        // paresSliderTexto.put(velSlider, velValue);
        // paresSliderTexto.put(accelSlider, accelValue);

        // // End this monstruosity
        // paresTextoSlider.put(j1Value, j1Slider);
        // paresTextoSlider.put(j2Value, j2Slider);
        // paresTextoSlider.put(j3Value, j3Slider);
        // paresTextoSlider.put(zValue, zSlider);
        // paresTextoSlider.put(gripperValue, gripperSlider);
        // paresTextoSlider.put(velValue, velSlider);
        // paresTextoSlider.put(accelValue, accelSlider);

        // // I absolutely despise you
        // j1Value.setText(Math.round(j1Slider.getValue()) + "");
        // j2Value.setText(Math.round(j2Slider.getValue()) + "");
        // j3Value.setText(Math.round(j3Slider.getValue()) + "");
        // zValue.setText(Math.round(zSlider.getValue()) + "");
        // gripperValue.setText(Math.round(gripperSlider.getValue()) + "");
        // velValue.setText(Math.round(velSlider.getValue()) + "");
        // accelValue.setText(Math.round(accelSlider.getValue()) + "");

        // You are alright, little one
        sendData();

    }

    // Construir el array de datos a enviar y enviarlo por serial.
    @FXML
    public void sendData() {
        int[] datos = {
                0,
                0,
                (int) j1Slider.getValue(),
                (int) j2Slider.getValue(),
                (int) j3Slider.getValue(),
                (int) zSlider.getValue(),
                (int) gripperSlider.getValue(),
                (int) velSlider.getValue(),
                (int) accelSlider.getValue()
        };
        SerialMessenger.send(datos, "/dev/ttyUSB0", false);
    }

    // Actualizar din√°micamente el valor del campo luego de mover el slider
    @FXML
    public void updateTextFieldValue(Event event) {
        Slider slider = (Slider) event.getSource();
        double value = Math.round(((Slider) event.getSource()).getValue());
        paresSliderTexto.get(slider).setText(value + "");
        slider.setValue(value);
    }

    // Actualizar el valor del slider luego de ingresar un valor por el campo
    @FXML
    public void updateSliderValue(KeyEvent event) {
        if (event.getCode() == KeyCode.ENTER) {
            TextField textField = (TextField) event.getSource();
            Slider slider = paresTextoSlider.get(textField);
            double value = Math.round(Double.valueOf(textField.getText()));
            slider.setValue(value);
            sendData();
        }
    }
}
